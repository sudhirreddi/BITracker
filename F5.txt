-- ============================================= -- Author:      Vidya Ganesh -- Create Date: 31/01/2018 -- Description: Given the OwnerId, retrieves information regarding tenant job requests 			--  Elaborate - find all job requests (where tenants and isActive is True). 			--	Place in three columns - New, Accepted, Declined -- ============================================= CREATE PROCEDURE PO_TenantRequest (     -- Add the parameters for the stored procedure here 	@OwnerId int )  AS BEGIN    	-- Add SQL statements for the stored procedure here 	SELECT t.OwnerId, t.Title, t.JobDescription, t.JobStatusID 	FROM TenantJobRequest t 	WHERE t.OwnerId = @OwnerId  END 
-- ============================================= -- Author:      Vidya Ganesh -- Create Date: 12/02/2018 -- Description: Find all job requests (where tenants and property isActive = True). 			--	Place in three columns - New (1), Accepted (2), Pending (3), Declined (5) -- ============================================= CREATE PROCEDURE PO_JobRequest  (     -- Add the parameters for the stored procedure here 	@RequestStatusId int  ) AS BEGIN    	-- Add SQL statements for the stored procedure here 	SELECT pr.PropertyId, pr.RequestMessage, pr.RequestStatusId 	FROM PropertyRequest pr, Tenant tn 	WHERE tn.IsActive = 'True' AND pr.IsActive = 'True' 	AND pr.RequestStatusId = @RequestStatusId  END 
Create procedure RA_DashBoard  @ownerid INT AS DECLARE @NEW INT, @APPROVED INT, @REJECTED INT, @PENDING INT, @TOTAL INT  BEGIN select @NEW =count(1) from RentalApplication where ApplicationStatusId=1 and PersonId=@ownerid select @APPROVED=count(1)  from RentalApplication where ApplicationStatusId=2 and PersonId=@ownerid select @REJECTED=count(1) from RentalApplication where ApplicationStatusId=3 and PersonId=@ownerid select @PENDING=count(1) from RentalApplication where IsViewedByOwner=1 and PersonId=@ownerid select @TOTAL=count(1) FROM RentalApplication where PersonId=@ownerid  SELECT @NEW AS NEW,@APPROVED AS APPROVED,@REJECTED AS REJECTED,@PENDING AS PENDING,@TOTAL AS TOTAL INTO #TBL  SELECT * FROM #TBL END
CREATE PROCEDURE [dbo].[RATest] 		@OwnerId INT AS  BEGIN  SELECT               count( case when ra.ApplicationStatusId = 1 and op.OwnerId =@OwnerId then 1 ELSE NULL END) AS 'NEW',         count( case when ra.ApplicationStatusId = 2 THEN 1 ELSE NULL END) AS 'ACCEPTED' ,         count( case when IsViewedByOwner=1  THEN 1 ELSE NULL END) AS 'PENDING',         count( case when ra.ApplicationStatusId = 3 THEN 1 ELSE NULL END) AS 'REJECTED',         count( case when ra.ApplicationStatusId = 1 and op.OwnerId =@OwnerId then 1 ELSE NULL END)+count( case when ra.ApplicationStatusId = 2 THEN 1 ELSE NULL END) +(count( case when IsViewedByOwner=1  THEN 1 ELSE NULL END) +count( case when ra.ApplicationStatusId = 3 THEN 1 ELSE NULL END) ) AS 'TOTAL'          FROM RentalApplication ra                  inner join RentalApplicationStatus ras ON ra.ApplicationStatusId = ras.Id                   inner join RentalListing rl on ra.RentalListingId = rl.id                    inner join Property pr on rl.PropertyId = pr.Id                   inner join OwnerProperty op on pr.Id = op.PropertyID                    where op.OwnerId = @OwnerId 	/*SELECT @NEW = count(1) FROM RentalApplication ra                   inner join RentalApplicationStatus ras ON ra.ApplicationStatusId = ras.Id 				  inner join RentalListing rl on ra.RentalListingId = rl.id  				  inner join Property pr on rl.PropertyId = pr.Id 				  inner join OwnerProperty op on pr.Id = op.PropertyID  				  where op.OwnerId = @OwnerId and ra.ApplicationStatusId = 1   	SELECT @ACCEPTED = count(1) FROM RentalApplication ra                   inner join RentalApplicationStatus ras ON ra.ApplicationStatusId = ras.Id 				  inner join RentalListing rl on ra.RentalListingId = rl.id  				  inner join Property pr on rl.PropertyId = pr.Id 				  inner join OwnerProperty op on pr.Id = op.PropertyID  				  where op.OwnerId = @OwnerId and ra.ApplicationStatusId = 2   	SELECT @PENDING = count(1) FROM RentalApplication ra                   inner join RentalApplicationStatus ras ON ra.ApplicationStatusId = ras.Id 				  inner join RentalListing rl on ra.RentalListingId = rl.id  				  inner join Property pr on rl.PropertyId = pr.Id 				  inner join OwnerProperty op on pr.Id = op.PropertyID  				  where op.OwnerId = @OwnerId and ra.IsViewedByOwner=1  	SELECT @REJECTED = count(1) FROM RentalApplication ra                   inner join RentalApplicationStatus ras ON ra.ApplicationStatusId = ras.Id 				  inner join RentalListing rl on ra.RentalListingId = rl.id  				  inner join Property pr on rl.PropertyId = pr.Id 				  inner join OwnerProperty op on pr.Id = op.PropertyID  				  where op.OwnerId = @OwnerId and ra.ApplicationStatusId = 3   	SELECT @TOTAL = @NEW+@ACCEPTED+@PENDING+@REJECTED   	SELECT @NEW AS NEW,@ACCEPTED AS ACCEPTED,@PENDING AS PENDING,@REJECTED AS REJECTED ,@TOTAL AS TOTAL INTO #TEMP 	SELECT * FROM #TEMP*/  END
